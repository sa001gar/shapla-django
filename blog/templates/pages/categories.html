{% extends "base.html" %}

{% block content %}
<section id="category-posts" class="page-transition w-full max-w-7xl mx-auto">
    <!-- Category Header -->
    <div class="mb-12 border-b border-stone-200 pb-8 flex flex-col md:flex-row justify-between items-baseline gap-4">
        <div class="flex items-baseline gap-4">
            <h1 class="text-4xl md:text-5xl font-bold text-ink tracking-tight font-serif">{{ category.name }}</h1>
            <span class="px-3 py-1 bg-[#AA1C1C]/10 text-[#AA1C1C] rounded-full text-xs font-medium border border-[#AA1C1C]/20">
                {{ posts.paginator.count }} টি লেখা
            </span>
        </div>
        
        <!-- Optional: Simple Breadcrumb or Date -->
        <span class="text-stone-400 text-sm font-serif">{% now "j F, Y" %}</span>
    </div>

    <!-- Posts Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-12">
        {% for post in posts %}
        <article class="group cursor-pointer flex flex-col h-full" onclick="window.location.href='{% url 'post' post.category.slug post.slug %}'">
            <!-- Image -->
            <div class="relative overflow-hidden rounded-xl bg-stone-100 aspect-[16/10] mb-6 border border-stone-200 shadow-sm group-hover:shadow-md transition-all duration-300">
                {% if post.post_image %}
                <img src="{{ post.post_image.url }}" alt="{{ post.title }}" 
                     class="object-cover w-full h-full group-hover:scale-105 transition-transform duration-700">
                {% else %}
                <div class="flex items-center justify-center w-full h-full text-stone-300 bg-stone-50">
                    <iconify-icon icon="lucide:image" width="48"></iconify-icon>
                </div>
                {% endif %}
                
                <!-- Overlay badge for 'Latest' or similar could go here -->
            </div>

            <!-- Content -->
            <div class="flex flex-col grow">
                <h2 class="text-2xl font-bold text-ink mb-3 group-hover:text-[#AA1C1C] transition-colors leading-tight font-serif">
                    {{ post.title }}
                </h2>
                
                <p class="text-stone-600 flex-grow mb-4 text-justify line-clamp-3 leading-relaxed text-sm font-light">
                    {{ post.description|default:post.post_text|striptags|truncatewords:25|safe }}
                </p>

                <div class="flex items-center gap-2 text-xs text-stone-400 font-medium pt-4 border-t border-stone-100 mt-auto">
                    <iconify-icon icon="lucide:clock" width="14"></iconify-icon>
                    <span>{{ post.created_at|date:"j F, Y" }}</span>
                </div>
            </div>
        </article>
        {% empty %}
        <div class="col-span-full py-20 text-center bg-stone-50 rounded-2xl border border-stone-100">
            <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-stone-100 mb-4">
                <iconify-icon icon="lucide:file-x" class="text-stone-400" width="32"></iconify-icon>
            </div>
            <h3 class="text-lg font-medium text-ink">কোনো লেখা পাওয়া যায়নি</h3>
            <p class="text-stone-500 mt-1">এই বিভাগে এখনও কোনো লেখা যোগ করা হয়নি।</p>
        </div>
        {% endfor %}
    </div>

    <!-- Pagination -->
    {% if posts.has_other_pages %}
    <div class="flex justify-center gap-2 mt-16 border-t border-stone-100 pt-8">
            {% if posts.has_previous %}
        <a href="?page={{ posts.previous_page_number }}"
            class="w-10 h-10 flex items-center justify-center rounded-full border border-stone-200 text-stone-500 hover:bg-[#AA1C1C] hover:text-white hover:border-[#AA1C1C] transition-colors"><iconify-icon
                icon="lucide:chevron-left" width="18"></iconify-icon></a>
            {% endif %}

            {% for i in posts.paginator.page_range %}
            {% if posts.number == i %}
            <span class="w-10 h-10 flex items-center justify-center rounded-full bg-[#AA1C1C] text-white font-serif text-sm font-medium shadow-md shadow-[#AA1C1C]/20">{{ i }}</span>
            {% else %}
            <a href="?page={{ i }}"
                class="w-10 h-10 flex items-center justify-center rounded-full border border-stone-200 text-stone-500 hover:bg-white hover:text-[#AA1C1C] hover:border-[#AA1C1C] transition-colors font-serif text-sm">{{ i }}</a>
            {% endif %}
            {% endfor %}

            {% if posts.has_next %}
        <a href="?page={{ posts.next_page_number }}"
            class="w-10 h-10 flex items-center justify-center rounded-full border border-stone-200 text-stone-500 hover:bg-[#AA1C1C] hover:text-white hover:border-[#AA1C1C] transition-colors"><iconify-icon
                icon="lucide:chevron-right" width="18"></iconify-icon></a>
            {% endif %}
    </div>
    {% endif %}
</section>
{% endblock %}