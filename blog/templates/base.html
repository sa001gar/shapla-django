{% load static tailwind_tags %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Shapla | Where Literature Meets Life</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <meta name="description" content="Shapla | Where Literature Meets Life">
        <meta name="keywords" content="Shapla, Literature, Life">
        <meta name="author" content="Mainak Majumder">

        <!-- Preconnect & DNS-Prefetch -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="dns-prefetch" href="https://fonts.googleapis.com">
        <link rel="dns-prefetch" href="https://fonts.gstatic.com">
        <link rel="dns-prefetch" href="https://code.iconify.design">

        <!-- Fonts -->
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@300;400;500;600;700&amp;family=Playfair+Display:ital,wght@0,400;0,600;1,400&amp;family=Inter:wght@400;500;600&amp;display=swap"
              rel="stylesheet">

        <!-- Tailwind CSS -->
        {% tailwind_css %}
        <link rel="stylesheet" href="{% static 'css/prose_custom.css' %}">
        
        <!-- Favicon -->
        <link rel="icon" href="{% static 'assets/favicon.png' %}">

        <style>
        /* Loader Styles */
        #page-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #fffaf0; /* Using cream color matching body */
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
        }

        #page-loader.hidden-loader {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        /* Premium Dots Animation */
        .loader-dots {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 1rem;
        }
        
        .loader-dot {
            width: 8px;
            height: 8px;
            margin: 0 4px;
            background-color: #44403c; /* stone-700 */
            border-radius: 50%;
            display: inline-block;
            animation: bounce 1.4s infinite ease-in-out both;
        }
        
        .loader-dot:nth-child(1) { animation-delay: -0.32s; }
        .loader-dot:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #e5e5e5;
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #d4d4d4;
        }

        .prose-bengali {
            font-family: 'Noto Sans Bengali', sans-serif;
            line-height: 1.9;
        }

        /* Custom Checkbox */
        .custom-checkbox {
            appearance: none;
            background-color: transparent;
            margin: 0;
        }

        .custom-checkbox+label {
            position: relative;
            padding-left: 28px;
            cursor: pointer;
            user-select: none;
        }

        .custom-checkbox+label::before {
            content: '';
            position: absolute;
            left: 0;
            top: 2px;
            width: 18px;
            height: 18px;
            border: 1.5px solid #d6d3d1;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .custom-checkbox:checked+label::before {
            background-color: #AA1C1C;
            border-color: #AA1C1C;
        }

        .custom-checkbox:checked+label::after {
            content: '';
            position: absolute;
            left: 6px;
            top: 6px;
            width: 6px;
            height: 10px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }

        .hidden-section {
            display: none !important;
        }

        .page-transition {
            animation: fadeIn 0.4s ease-out forwards;
        }

        /* Mobile Menu Transitions */
        .mobile-menu-open {
            overflow: hidden;
        }

        #mobile-menu {
            transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .menu-hidden {
            transform: translateX(100%);
        }

        .menu-visible {
            transform: translateX(0);
        }
        </style>
    </head>
    <body class="bg-cream text-stone font-bengali antialiased min-h-screen flex flex-col selection:bg-ink selection:text-white">
        
        <!-- Page Loader -->
        <div id="page-loader">
            {% include "layout/loader.html" %}
        </div>

        {% include "layout/header.html" %}
        <!-- Main Content Area -->
        <main id="main-container"
              class="flex grow w-full max-w-7xl mx-auto px-4 sm:px-6 py-8">
            {% block content %}{% endblock %}
        </main>
        {% include "layout/footer.html" %}
        
        <script>
            // Loader Logic
            window.addEventListener('load', function() {
                const loader = document.getElementById('page-loader');
                setTimeout(function() {
                    loader.classList.add('hidden-loader');
                }, 500); // Small delay to ensure smooth transition
            });

            const mobileMenu = document.getElementById('mobile-menu');
            const menuIcon = document.getElementById('menu-icon');
            let isMenuOpen = false;

            function toggleMobileMenu() {
                isMenuOpen = !isMenuOpen;
                if (isMenuOpen) {
                    mobileMenu.classList.remove('menu-hidden');
                    mobileMenu.classList.add('menu-visible');
                    document.body.classList.add('mobile-menu-open');
                    menuIcon.setAttribute('icon', 'lucide:x');
                } else {
                    mobileMenu.classList.remove('menu-visible');
                    mobileMenu.classList.add('menu-hidden');
                    document.body.classList.remove('mobile-menu-open');
                    menuIcon.setAttribute('icon', 'lucide:menu');
                }
            }
        </script>
        
        <!-- Iconify - Deferred -->
        <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js" defer></script>
        {% block extra_js %}{% endblock %}
    </body>
</html>
